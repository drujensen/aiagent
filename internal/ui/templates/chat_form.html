{{define "chat_form_content"}}
<div class="chat-welcome">
    {{if not .IsEdit}}
    <h1>Start a New Conversation</h1>
    <p>Choose how you'd like to begin</p>
    <div class="quick-start-options">
       <div class="option-card" onclick="startWithDefaults()">
           <div class="option-icon">ðŸš€</div>
           <h3>Quick Start</h3>
           <p>Get started immediately with smart defaults</p>
           <small>Research Agent + GPT-4.1 Standard</small>
       </div>
    </div>
    {{end}}

    <form
       {{if .IsEdit}}hx-put="/chats/{{.Chat.ID}}"{{else}}hx-post="/chats"{{end}}
       hx-target="#response-message"
       hx-swap="innerHTML">
      <h2 style="">{{if .IsEdit}}Edit Chat{{else}}Create Chat{{end}}</h2>
      <div class="form-group" style="margin-bottom: 20px; text-align: left;">
         <label for="chat-name" style="display: block; margin-bottom: 5px; font-weight: bold; color: #fff;">Conversation Name:</label>
         <input type="text" id="chat-name" name="chat-name" class="form-control" placeholder="Enter conversation name (optional)" value="{{.Chat.Name}}">
         <small class="form-text" style="display: block; margin-top: 5px; font-size: 12px; color: #ccc;">Leave blank to auto-generate based on your first message</small>
      </div>
      <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
         <div class="form-group" style="text-align: left;">
             <label for="agent-select" style="display: block; margin-bottom: 5px; font-weight: bold; color: #fff;">AI Agent:</label>
             <select id="agent-select" name="agent-select" class="form-control">
                 <option value="">Select an AI Agent</option>
                 {{range .Agents}}
                 <option value="{{.ID}}"{{if (eq .ID $.Chat.AgentID)}}selected{{end}}>{{.Name}}</option>
                 {{end}}
             </select>
             <small class="form-text" style="display: block; margin-top: 5px; font-size: 12px; color: #ccc;">Defines the AI's behavior and personality</small>
         </div>
         <div class="form-group" style="text-align: left;">
             <label for="model-select" style="display: block; margin-bottom: 5px; font-weight: bold; color: #fff;">AI Model:</label>
             <select id="model-select" name="model-select" class="form-control">
                 <option value="">Select an AI Model</option>
                 {{range .Models}}
                 <option value="{{.ID}}"{{if (eq .ID $.Chat.ModelID)}}selected{{end}}>{{.Name}}</option>
                 {{end}}
             </select>
             <small class="form-text" style="display: block; margin-top: 5px; font-size: 12px; color: #ccc;">Controls speed, cost, and capabilities</small>
         </div>
      </div>
      <button type="submit" class="btn-primary">{{if .IsEdit}}Update{{else}}Create{{end}} Chat</button>
    </form>
    <div id="response-message"></div>
</div>

<style>
  .chat-welcome {
      background: #333;
      border: 1px solid #444;
      padding: 20px;
      border-radius: 8px;
      max-width: 800px;
      margin: 0 auto;
      text-align: center;
  }

  .chat-welcome h1 {
      color: #fff;
      margin-bottom: 10px;
      font-size: 2.5em;
  }

  .chat-welcome h2 {
    color: #fff;
    margin-bottom: 30px;
    border-bottom: 2px solid #444;
  }

  .chat-welcome > p {
      color: #ccc;
      font-size: 1.2em;
      margin-bottom: 40px;
  }

  .quick-start-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
  }

  .option-card {
      border: 2px solid #555;
      border-radius: 12px;
      padding: 30px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #2a2a2a;
      color: #fff;
  }

  .option-card:hover {
      border-color: #007bff;
      box-shadow: 0 4px 12px rgba(0,123,255,0.15);
      transform: translateY(-2px);
      background: #3a3a3a;
  }

  .option-icon {
      font-size: 2.5em;
      margin-bottom: 15px;
  }

  .option-card h3 {
      color: #fff;
      margin: 0 0 10px 0;
      font-size: 1.4em;
  }

  .option-card p {
      color: #ccc;
      margin: 0 0 15px 0;
      font-size: 1em;
  }

  .option-card small {
      color: #aaa;
      font-size: 0.9em;
  }

  .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
  }

  .form-group {
      text-align: left;
  }

  .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #fff;
  }

  .form-control {
      width: 100%;
      padding: 10px;
      border: 1px solid #555;
      border-radius: 4px;
      font-size: 14px;
      box-sizing: border-box;
      background-color: #1a1a1a;
      color: #fff;
  }

  .form-control:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
      background-color: #2a2a2a;
  }

  .form-text {
      display: block;
      margin-top: 5px;
      font-size: 12px;
      color: #ccc;
  }

  .form-actions {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 30px;
  }

  .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
      text-decoration: none;
      display: inline-block;
      text-align: center;
  }

  .btn-secondary {
      background: #6c757d;
      color: white;
  }

  .btn-secondary:hover {
      background: #545b62;
      transform: translateY(-1px);
  }

  @media (max-width: 768px) {
      .form-row {
          grid-template-columns: 1fr;
          gap: 15px;
      }

      .quick-start-options {
          grid-template-columns: 1fr;
      }
  }
</style>

<script>
function startWithDefaults() {
    // Auto-create chat with default agent and model
    fetch('/chats', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            name: '',
            agent_id: '',  // Will use default
            model_id: ''   // Will use default
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.id) {
            window.location.href = '/chats/' + data.id;
        } else {
            alert('Failed to create chat');
        }
    })
    .catch(error => {
        alert('Failed to create chat: ' + error.message);
    });
}

function showAdvancedOptions() {
    document.querySelector('.quick-start-options').style.display = 'none';
    document.getElementById('advanced-options').style.display = 'block';
}

function hideAdvancedOptions() {
    document.getElementById('advanced-options').style.display = 'none';
    document.querySelector('.quick-start-options').style.display = 'grid';
}
</script>
{{end}}
