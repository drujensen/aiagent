{{define "chat_form_content"}}
<main class="content">
  <div class="home-content">
      <div class="chat-welcome">
          <h1>{{if .IsEdit}}Edit Conversation{{else}}Start a New Conversation{{end}}</h1>
          <p>{{if .IsEdit}}Update your conversation details{{else}}Choose how you'd like to begin{{end}}</p>

          <div class="quick-start-options">
              <div class="option-card" onclick="startWithDefaults()">
                  <div class="option-icon">üöÄ</div>
                  <h3>Quick Start</h3>
                  <p>Get started immediately with smart defaults</p>
                  <small>Research Agent + GPT-4.1 Standard</small>
              </div>

              <div class="option-card" onclick="showAdvancedOptions()">
                  <div class="option-icon">‚öôÔ∏è</div>
                  <h3>Custom Setup</h3>
                  <p>Choose your agent and model</p>
                  <small>Full control over configuration</small>
              </div>
          </div>

          <div id="advanced-options" class="advanced-options" style="display: none;">
              <form
                  {{if .IsEdit}}hx-put="/chats/{{.Chat.ID}}"{{else}}hx-post="/chats"{{end}}
                  hx-target="#response-message"
                  hx-swap="innerHTML">
                  <div class="form-group">
                      <label for="chat-name">Conversation Name:</label>
                      <input type="text" id="chat-name" name="chat-name" class="form-control" placeholder="Enter conversation name (optional)" value="{{.Chat.Name}}">
                      <small class="form-text">Leave blank to auto-generate based on your first message</small>
                  </div>
                  <div class="form-row">
                      <div class="form-group">
                          <label for="agent-select">AI Agent:</label>
                          <select id="agent-select" name="agent-select" class="form-control">
                              <option value="">Select an AI Agent</option>
                              {{range .Agents}}
                              <option value="{{.ID}}"{{if (eq .ID $.Chat.AgentID)}}selected{{end}}>{{.Name}}</option>
                              {{end}}
                          </select>
                          <small class="form-text">Defines the AI's behavior and personality</small>
                      </div>
                      <div class="form-group">
                          <label for="model-select">AI Model:</label>
                          <select id="model-select" name="model-select" class="form-control">
                              <option value="">Select an AI Model</option>
                              {{range .Models}}
                              <option value="{{.ID}}"{{if (eq .ID $.Chat.ModelID)}}selected{{end}}>{{.Name}}</option>
                              {{end}}
                          </select>
                          <small class="form-text">Controls speed, cost, and capabilities</small>
                      </div>
                  </div>
                  <div class="form-actions">
                      <button type="submit" class="btn btn-primary">{{if .IsEdit}}Save Chat{{else}}Start Chat{{end}}</button>
                      <button type="button" class="btn btn-secondary" onclick="hideAdvancedOptions()">Cancel</button>
                  </div>
              </form>
          </div>

          <div id="response-message"></div>
      </div>
  </div>
</main>

<style>
.chat-welcome {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
    padding: 40px 20px;
}

.chat-welcome h1 {
    color: #333;
    margin-bottom: 10px;
    font-size: 2.5em;
}

.chat-welcome > p {
    color: #666;
    font-size: 1.2em;
    margin-bottom: 40px;
}

.quick-start-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.option-card {
    border: 2px solid #e9ecef;
    border-radius: 12px;
    padding: 30px 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: white;
}

.option-card:hover {
    border-color: #007bff;
    box-shadow: 0 4px 12px rgba(0,123,255,0.15);
    transform: translateY(-2px);
}

.option-icon {
    font-size: 2.5em;
    margin-bottom: 15px;
}

.option-card h3 {
    color: #333;
    margin: 0 0 10px 0;
    font-size: 1.4em;
}

.option-card p {
    color: #666;
    margin: 0 0 15px 0;
    font-size: 1em;
}

.option-card small {
    color: #888;
    font-size: 0.9em;
}

.advanced-options {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 30px;
    margin-top: 20px;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
}

.form-group {
    text-align: left;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #333;
}

.form-control {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    box-sizing: border-box;
}

.form-control:focus {
    outline: none;
    border-color: #007bff;
    box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
}

.form-text {
    display: block;
    margin-top: 5px;
    font-size: 12px;
    color: #666;
}

.form-actions {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 30px;
}

.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
    text-decoration: none;
    display: inline-block;
    text-align: center;
}

.btn-primary {
    background: #007bff;
    color: white;
}

.btn-primary:hover {
    background: #0056b3;
    transform: translateY(-1px);
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #545b62;
    transform: translateY(-1px);
}

@media (max-width: 768px) {
    .form-row {
        grid-template-columns: 1fr;
        gap: 15px;
    }

    .quick-start-options {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
function startWithDefaults() {
    // Auto-create chat with default agent and model
    fetch('/chats', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            name: '',
            agent_id: '',  // Will use default
            model_id: ''   // Will use default
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.id) {
            window.location.href = '/chats/' + data.id;
        } else {
            alert('Failed to create chat');
        }
    })
    .catch(error => {
        alert('Failed to create chat: ' + error.message);
    });
}

function showAdvancedOptions() {
    document.querySelector('.quick-start-options').style.display = 'none';
    document.getElementById('advanced-options').style.display = 'block';
}

function hideAdvancedOptions() {
    document.getElementById('advanced-options').style.display = 'none';
    document.querySelector('.quick-start-options').style.display = 'grid';
}
</script>
{{end}}
