{{define "message_session_partial"}}
<!-- User Message -->
<div class="message user-message">
  <div class="message-content">{{renderMarkdown .UserMessage.Content}}</div>
</div>

<!-- AI Response Messages -->
{{range .AIMessages}}
  {{if eq .Role "assistant"}}
    <div class="message agent-message">
      <div class="message-content">{{renderMarkdown .Content}}</div>
    </div>
   {{else if eq .Role "tool"}}
     <div class="message tool-message">
       <div class="message-content">{{renderMarkdown .Content}}</div>
       {{range .ToolCallEvents}}
         <div class="tool-event">
           <div class="tool-name">{{.ToolName}}</div>
           <div class="tool-result">{{.Result}}</div>
           {{if .Diff}}
             <div class="tool-diff">
               <pre>{{.Diff}}</pre>
             </div>
           {{end}}
           {{if .Error}}
             <div class="tool-error">{{.Error}}</div>
           {{end}}
         </div>
       {{end}}
     </div>
   {{end}}
{{end}}
{{end}}