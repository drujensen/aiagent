{{define "message_session_partial"}}
<!-- User Message -->
<div class="message user-message">
  <div class="message-content">{{renderMarkdown .UserMessage.Content}}</div>
</div>

<!-- AI Response Messages -->
{{range .AIMessages}}
  {{if eq .Role "assistant"}}
    <div class="message agent-message">
      <div class="message-content">{{renderMarkdown .Content}}</div>
    </div>
     {{else if eq .Role "tool"}}
       <div class="message tool-message">
          {{range .ToolCallEvents}}
            <div class="tool-event">
              <div class="tool-name">{{formatToolName .ToolName .Arguments}}</div>
              <div class="tool-result">{{formatToolResult .ToolName .Result .Diff .Arguments}}</div>
             {{if .Error}}
               <div class="tool-error">{{.Error}}</div>
             {{end}}
           </div>
         {{end}}
       </div>
   {{end}}
{{end}}
{{end}}